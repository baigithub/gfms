import{a as l}from"./index-D5GkNzM3.js";import{u as a,E as r}from"./index-D4Rku7DI.js";const n=l.create({baseURL:"/api",timeout:3e4});n.interceptors.request.use(e=>{const o=a();return o.token&&(e.headers.Authorization=`Bearer ${o.token}`),e},e=>Promise.reject(e));n.interceptors.response.use(e=>(e.config.responseType==="blob",e.data),e=>{var i;const o=a();if(e.response){const{status:s,data:t}=e.response;((i=e.response.config)==null?void 0:i.responseType)==="blob"&&t instanceof Blob?t.text().then(u=>{try{const c=JSON.parse(u);r.error(c.detail||"请求失败")}catch{r.error("请求失败")}}):s===401?(o.logout(),window.location.href="/login",r.error("登录已过期，请重新登录")):s===403?r.error("没有权限访问"):s===404?r.error("请求的资源不存在"):s===500?r.error("服务器错误"):r.error((t==null?void 0:t.detail)||"请求失败")}else e.code==="ECONNABORTED"?r.error("请求超时"):r.error("网络错误");return Promise.reject(e)});export{n as r};
