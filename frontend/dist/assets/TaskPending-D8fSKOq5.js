import{_ as T,p as S,n as P,o as m,c as N,b as s,w as n,r as l,m as g,j as q,d as B,q as V,Q as Y,S as F,s as M,i,t as c,a as f,T as $}from"./index-DDrUN6p6.js";import{e as R}from"./green_finance-B4o63B-q.js";import{u as U}from"./tabs-DyOH422c.js";import"./index-B2NntqTq.js";import"./index-D5GkNzM3.js";const A={class:"task-page"},E={__name:"TaskPending",setup(G){const y=B(),b=V(),h=U(),d=g(!1),u=g([]),r=q({page:1,page_size:10,total:0}),k=e=>e?Number(e).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",_=e=>e?$(e).format("YYYY-MM-DD"):"-",v=e=>{if(e.formatted_category)return e.formatted_category;const t=[];return e.project_category_large&&t.push(e.project_category_large),e.project_category_medium&&t.push(e.project_category_medium),e.project_category_small&&t.push(e.project_category_small),t.join("/")||"-"},p=async()=>{d.value=!0;try{const e=await R({page:r.page,page_size:r.page_size});u.value=e.items,r.total=e.total}catch(e){console.error("Failed to load tasks:",e)}finally{d.value=!1}},z=e=>{const t=`任务详情 - ${e.customer_name}`,o=`/task-detail/${e.task_id}`;h.addTab({path:o,title:t,query:{from:"pending"}}),y.push({path:o,query:{from:"pending"}})};return S(()=>{p()}),P(()=>b.query.t,()=>{p()}),(e,t)=>{const o=l("el-table-column"),j=l("el-button"),x=l("el-table"),D=l("el-pagination"),C=l("el-card"),w=Y("loading");return m(),N("div",A,[s(C,{shadow:"hover"},{header:n(()=>[...t[2]||(t[2]=[f("div",{class:"card-header"},[f("span",{class:"card-title"},"待办任务")],-1)])]),default:n(()=>[F((m(),M(x,{data:u.value,stripe:"",style:{width:"100%"}},{default:n(()=>[s(o,{type:"index",label:"序号",width:"60"}),s(o,{prop:"customer_name",label:"客户名称","min-width":"150"}),s(o,{prop:"business_type",label:"业务品种",width:"150"}),s(o,{prop:"loan_account",label:"贷款账号",width:"150"}),s(o,{prop:"loan_amount",label:"放款金额(元)",width:"120"},{default:n(({row:a})=>[i(c(k(a.loan_amount)),1)]),_:1}),s(o,{prop:"disbursement_date",label:"放款日",width:"120"},{default:n(({row:a})=>[i(c(_(a.disbursement_date)),1)]),_:1}),s(o,{label:"绿色金融支持项目目录","min-width":"250"},{default:n(({row:a})=>[i(c(v(a)),1)]),_:1}),s(o,{prop:"deadline",label:"任务办理截止日期",width:"150"},{default:n(({row:a})=>[i(c(a.deadline?_(a.deadline):"-"),1)]),_:1}),s(o,{label:"操作",width:"120",fixed:"right"},{default:n(({row:a})=>[s(j,{type:"primary",link:"",size:"small",onClick:I=>z(a)},{default:n(()=>[...t[3]||(t[3]=[i(" 办理 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[w,d.value]]),s(D,{"current-page":r.page,"onUpdate:currentPage":t[0]||(t[0]=a=>r.page=a),"page-size":r.page_size,"onUpdate:pageSize":t[1]||(t[1]=a=>r.page_size=a),total:r.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:p,onCurrentChange:p,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}},O=T(E,[["__scopeId","data-v-ae2ac339"]]);export{O as default};
