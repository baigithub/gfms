import{_ as F,s as R,o as z,c as q,b as e,w as a,E as u,r as n,p as h,n as C,$ as A,e as w,aa as G,m as _,S as J,an as K,a1 as O,i as Q,t as W,L as V}from"./index-D4Rku7DI.js";import{a as X,c as Z,e as ee}from"./log-5VaKRiFa.js";import"./request-BnFmk4vl.js";import"./index-D5GkNzM3.js";const te={class:"log-login-container"},ae={__name:"LogLogin",setup(le){const f=h(!1),v=h([]),d=h([]),s=C({user_account:"",status:"",start_time:"",end_time:""}),r=C({page:1,page_size:10,total:0}),c=async()=>{f.value=!0;try{const o={page:r.page,page_size:r.page_size,...s},t=await X(o);v.value=t.data,r.total=t.total}catch(o){u.error("获取登录日志失败"),console.error(o)}finally{f.value=!1}},L=()=>{r.page=1,c()},M=()=>{s.user_account="",s.status="",s.start_time="",s.end_time="",r.page=1,c()},k=async o=>{try{await V.confirm("确定要删除这条日志吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ee(o),u.success("删除成功"),c()}catch(t){t!=="cancel"&&(u.error("删除失败"),console.error(t))}},B=async()=>{try{await V.confirm(`确定要删除选中的 ${d.value.length} 条日志吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Z(d.value),u.success("批量删除成功"),d.value=[],c()}catch(o){o!=="cancel"&&(u.error("批量删除失败"),console.error(o))}},H=o=>{d.value=o.map(t=>t.id)},S=o=>{r.page=o,c()},U=o=>{r.page_size=o,r.page=1,c()};return R(()=>{c()}),(o,t)=>{const T=n("el-input"),m=n("el-form-item"),p=n("el-col"),y=n("el-option"),E=n("el-select"),x=n("el-date-picker"),D=n("el-row"),b=n("el-icon"),g=n("el-button"),I=n("el-form"),Y=n("el-card"),i=n("el-table-column"),P=n("el-tag"),$=n("el-table"),N=n("el-pagination"),j=A("loading");return z(),q("div",te,[e(Y,{class:"search-card"},{default:a(()=>[e(I,{inline:!0,model:s,class:"search-form"},{default:a(()=>[e(D,{gutter:20},{default:a(()=>[e(p,{xs:24,sm:12,md:6},{default:a(()=>[e(m,{label:"用户账号"},{default:a(()=>[e(T,{modelValue:s.user_account,"onUpdate:modelValue":t[0]||(t[0]=l=>s.user_account=l),placeholder:"请输入用户账号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{xs:24,sm:12,md:6},{default:a(()=>[e(m,{label:"登录状态"},{default:a(()=>[e(E,{modelValue:s.status,"onUpdate:modelValue":t[1]||(t[1]=l=>s.status=l),placeholder:"请选择登录状态",clearable:"",style:{width:"100%"}},{default:a(()=>[e(y,{label:"成功",value:"success"}),e(y,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{xs:24,sm:12,md:6},{default:a(()=>[e(m,{label:"开始时间"},{default:a(()=>[e(x,{modelValue:s.start_time,"onUpdate:modelValue":t[2]||(t[2]=l=>s.start_time=l),type:"datetime",placeholder:"选择开始时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{xs:24,sm:12,md:6},{default:a(()=>[e(m,{label:"结束时间"},{default:a(()=>[e(x,{modelValue:s.end_time,"onUpdate:modelValue":t[3]||(t[3]=l=>s.end_time=l),type:"datetime",placeholder:"选择结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,null,{default:a(()=>[e(p,{span:24,class:"button-group"},{default:a(()=>[e(g,{type:"primary",onClick:L},{default:a(()=>[e(b,null,{default:a(()=>[e(w(G))]),_:1}),t[6]||(t[6]=_(" 查询 ",-1))]),_:1}),e(g,{onClick:M},{default:a(()=>[e(b,null,{default:a(()=>[e(w(J))]),_:1}),t[7]||(t[7]=_(" 重置 ",-1))]),_:1}),e(g,{type:"danger",onClick:B,disabled:d.value.length===0},{default:a(()=>[e(b,null,{default:a(()=>[e(w(K))]),_:1}),t[8]||(t[8]=_(" 批量删除 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Y,{class:"table-card"},{default:a(()=>[O((z(),Q($,{data:v.value,border:"",stripe:"",onSelectionChange:H},{default:a(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{prop:"login_time",label:"登录时间",width:"180",align:"center"}),e(i,{prop:"user_name",label:"登录人姓名",width:"120",align:"center"}),e(i,{prop:"user_account",label:"登录人账号",width:"120",align:"center"}),e(i,{prop:"ip_address",label:"登录IP",width:"140",align:"center"}),e(i,{prop:"device_type",label:"设备类型",width:"120",align:"center"}),e(i,{prop:"device_name",label:"设备名称",width:"150","show-overflow-tooltip":""}),e(i,{prop:"browser",label:"浏览器",width:"120","show-overflow-tooltip":""}),e(i,{prop:"os",label:"操作系统",width:"120","show-overflow-tooltip":""}),e(i,{prop:"status",label:"登录状态",width:"100",align:"center"},{default:a(({row:l})=>[e(P,{type:l.status==="success"?"success":"danger"},{default:a(()=>[_(W(l.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"failure_reason",label:"失败原因",width:"150","show-overflow-tooltip":""}),e(i,{label:"操作",width:"100",align:"center",fixed:"right"},{default:a(({row:l})=>[e(g,{type:"danger",size:"small",onClick:oe=>k(l.id)},{default:a(()=>[...t[9]||(t[9]=[_(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,f.value]]),e(N,{"current-page":r.page,"onUpdate:currentPage":t[4]||(t[4]=l=>r.page=l),"page-size":r.page_size,"onUpdate:pageSize":t[5]||(t[5]=l=>r.page_size=l),"page-sizes":[10,20,50,100],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:U,onCurrentChange:S,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1})])}}},ce=F(ae,[["__scopeId","data-v-6b2515cb"]]);export{ce as default};
